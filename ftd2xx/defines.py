from enum import unique, IntFlag, IntEnum
import sys

# Statuses
OK = 0
INVALID_HANDLE = 1
DEVICE_NOT_FOUND = 2
DEVICE_NOT_OPENED = 3
IO_ERROR = 4
INSUFFICIENT_RESOURCES = 5
INVALID_PARAMETER = 6
INVALID_BAUD_RATE = 7
DEVICE_NOT_OPENED_FOR_ERASE = 8
DEVICE_NOT_OPENED_FOR_WRITE = 9
FAILED_TO_WRITE_DEVICE = 10
EEPROM_READ_FAILED = 11
EEPROM_WRITE_FAILED = 12
EEPROM_ERASE_FAILED = 13
EEPROM_NOT_PRESENT = 14
EEPROM_NOT_PROGRAMMED = 15
INVALID_ARGS = 16
NOT_SUPPORTED = 17
OTHER_ERROR = 18

# List Devices flags
LIST_NUMBER_ONLY = 0x80000000
LIST_BY_INDEX = 0x40000000
LIST_ALL = 0x20000000


@unique
class OpenExFlags(IntFlag):
    """Used to indicate the type of identifier being passed to FT_OpenEx."""

    OPEN_BY_SERIAL_NUMBER = 1
    OPEN_BY_DESCRIPTION = 2

    if sys.platform == "win32":
        OPEN_BY_LOCATION = 4


OPEN_BY_SERIAL_NUMBER = OpenExFlags.OPEN_BY_SERIAL_NUMBER
OPEN_BY_DESCRIPTION = OpenExFlags.OPEN_BY_DESCRIPTION
if sys.platform == "win32":
    OPEN_BY_LOCATION = OpenExFlags.OPEN_BY_LOCATION


@unique
class ModemStatus(IntFlag):
    #: Clear to Send
    CTS = 0x10

    #: Data Set Ready
    DSR = 0x20

    #: Ring Indicator
    RI = 0x40

    #: Data Carrier Detect
    DCD = 0x80

    #: Data Ready
    DR = 0x100

    #: Overrun Error
    OE = 0x200

    #: Parity Error
    PE = 0x400

    #: Framing Error
    FE = 0x800

    #: Break Interrupt
    BI = 0x1000

    #: Transmitter Holding Register
    THRE = 0x2000

    #: Transmitter Empty
    TEMT = 0x4000

    #: Receiver FIFO Error
    RCVE = 0x8000


@unique
class Device(IntEnum):
    FT_232BM = 0
    FT_232AM = 1
    FT_100AX = 2
    UNKNOWN = 3
    FT_2232C = 4
    FT_232R = 5
    FT_2232H = 6
    FT_4232H = 7
    FT_232H = 8
    FT_X_SERIES = 9


# Device Identifiers
DEVICE_232BM = Device.FT_232BM
DEVICE_232AM = Device.FT_232AM
DEVICE_100AX = Device.FT_100AX
DEVICE_UNKNOWN = Device.UNKNOWN
DEVICE_2232C = Device.FT_2232C
DEVICE_232R = Device.FT_232R
DEVICE_2232H = Device.FT_2232H
DEVICE_4232H = Device.FT_4232H
DEVICE_232H = Device.FT_232H
DEVICE_X_SERIES = Device.FT_X_SERIES


@unique
class Status(IntEnum):
    OK = 0
    INVALID_HANDLE = 1
    DEVICE_NOT_FOUND = 2
    DEVICE_NOT_OPENED = 3
    IO_ERROR = 4
    INSUFFICIENT_RESOURCES = 5
    INVALID_PARAMETER = 6
    INVALID_BAUD_RATE = 7
    DEVICE_NOT_OPENED_FOR_ERASE = 8
    DEVICE_NOT_OPENED_FOR_WRITE = 9
    FAILED_TO_WRITE_DEVICE = 10
    EEPROM_READ_FAILED = 11
    EEPROM_WRITE_FAILED = 12
    EEPROM_ERASE_FAILED = 13
    EEPROM_NOT_PRESENT = 14
    EEPROM_NOT_PROGRAMMED = 15
    INVALID_ARGS = 16
    NOT_SUPPORTED = 17
    OTHER_ERROR = 18


# Driver Types
DRIVER_TYPE_D2XX = 0
DRIVER_TYPE_VCP = 1

# Word Lengths
BITS_8 = 8
BITS_7 = 7

# Stop Bits
STOP_BITS_1 = 0
STOP_BITS_2 = 2

# Parity
PARITY_NONE = 0
PARITY_ODD = 1
PARITY_EVEN = 2
PARITY_MARK = 3
PARITY_SPACE = 4


@unique
class Parity(IntEnum):
    PARITY_NONE = 0
    PARITY_ODD = 1
    PARITY_EVEN = 2
    PARITY_MARK = 3
    PARITY_SPACE = 4


# Flow Control
FLOW_NONE = 0x0000
FLOW_RTS_CTS = 0x0100
FLOW_DTR_DSR = 0x0200
FLOW_XON_XOFF = 0x0400


@unique
class FlowControl(IntFlag):
    FLOW_NONE = 0x0000
    FLOW_RTS_CTS = 0x0100
    FLOW_DTR_DSR = 0x0200
    FLOW_XON_XOFF = 0x0400


# Purge RX and TX Buffers
PURGE_RX = 1
PURGE_TX = 2

# Notification Events
EVENT_RXCHAR = 1
EVENT_MODEM_STATUS = 2
EVENT_LINE_STATUS = 4

MAX_DESCRIPTION_SIZE = 256


@unique
class BitMode(IntFlag):
    FT_BITMODE_RESET = 0x00
    FT_BITMODE_ASYNC_BITBANG = 0x01
    FT_BITMODE_MPSSE = 0x02
    FT_BITMODE_SYNC_BITBANG = 0x04
    FT_BITMODE_MCU_HOST = 0x08
    FT_BITMODE_FAST_SERIAL = 0x10
    FT_BITMODE_CBUS_BITBANG = 0x20
    FT_BITMODE_SYNC_FIFO = 0x40


@unique
class FT232R_CBUS_EEPROM_OPTION(IntEnum):
    FT_232R_CBUS_TXDEN = 0x00
    FT_232R_CBUS_PWRON = 0x01
    FT_232R_CBUS_RXLED = 0x02
    FT_232R_CBUS_TXLED = 0x03
    FT_232R_CBUS_TXRXLED = 0x04
    FT_232R_CBUS_SLEEP = 0x05
    FT_232R_CBUS_CLK48 = 0x06
    FT_232R_CBUS_CLK24 = 0x07
    FT_232R_CBUS_CLK12 = 0x08
    FT_232R_CBUS_CLK6 = 0x09
    FT_232R_CBUS_IOMODE = 0x0A
    FT_232R_CBUS_BITBANG_WR = 0x0B
    FT_232R_CBUS_BITBANG_RD = 0x0C


@unique
class FT232H_CBUS_EEPROM_OPTIONS(IntEnum):
    FT_232H_CBUS_TRISTATE = 0x00
    FT_232H_CBUS_RXLED = 0x01
    FT_232H_CBUS_TXLED = 0x02
    FT_232H_CBUS_TXRXLED = 0x03
    FT_232H_CBUS_PWREN = 0x04
    FT_232H_CBUS_SLEEP = 0x05
    FT_232H_CBUS_DRIVE_0 = 0x06
    FT_232H_CBUS_DRIVE_1 = 0x07
    FT_232H_CBUS_IOMODE = 0x08
    FT_232H_CBUS_TXDEN = 0x09
    FT_232H_CBUS_CLK30 = 0x0A
    FT_232H_CBUS_CLK15 = 0x0B
    FT_232H_CBUS_CLK7_5 = 0x0C


@unique
class FT_X_Series_CBUS_Options(IntEnum):
    FT_X_SERIES_CBUS_TRISTATE = 0x00
    FT_X_SERIES_CBUS_RXLED = 0x01
    FT_X_SERIES_CBUS_TXLED = 0x02
    FT_X_SERIES_CBUS_TXRXLED = 0x03
    FT_X_SERIES_CBUS_PWREN = 0x04
    FT_X_SERIES_CBUS_SLEEP = 0x05
    FT_X_SERIES_CBUS_DRIVE_0 = 0x06
    FT_X_SERIES_CBUS_DRIVE_1 = 0x07
    FT_X_SERIES_CBUS_IOMODE = 0x08
    FT_X_SERIES_CBUS_TXDEN = 0x09
    FT_X_SERIES_CBUS_CLK24 = 0x0A
    FT_X_SERIES_CBUS_CLK12 = 0x0B
    FT_X_SERIES_CBUS_CLK6 = 0x0C
    FT_X_SERIES_CBUS_BCD_CHARGER = 0x0D
    FT_X_SERIES_CBUS_BCD_CHARGER_N = 0x0E
    FT_X_SERIES_CBUS_I2C_TXE = 0x0F
    FT_X_SERIES_CBUS_I2C_RXF = 0x10
    FT_X_SERIES_CBUS_VBUS_SENSE = 0x11
    FT_X_SERIES_CBUS_BITBANG_WR = 0x12
    FT_X_SERIES_CBUS_BITBANG_RD = 0x13
    FT_X_SERIES_CBUS_TIMESTAMP = 0x14
    FT_X_SERIES_CBUS_KEEP_AWAKE = 0x15


OPEN_EXISTING = 3
FILE_ATTRIBUTE_NORMAL = 0x00000080
FILE_FLAG_OVERLAPPED = 0x40000000
GENERIC_READ = 0x80000000
GENERIC_WRITE = 0x40000000

CLRDTR = 6  # Clear the DTR signal
CLRRTS = 4  # Clear the RTS signal
SETDTR = 5  # Set the DTR signal
SETRTS = 3  # Set the RTS signal
SETBREAK = 8  # Set the BREAK condition
CLRBREAK = 9  # Clear the BREAK condition
MS_CTS_ON = 0x0010  # Clear To Send (CTS) is on
MS_DSR_ON = 0x0020  # Data Set Ready (DSR) is on
MS_RING_ON = 0x0040  # Ring Indicator (RI) is on
MS_RLSD_ON = 0x0080  # Receive Line Signal Detect (RLSD) is on

EV_BREAK = 0x0040  # BREAK condition detected
EV_CTS = 0x0008  # Change in Clear To Send (CTS)
EV_DSR = 0x0010  # Change in Data Set Ready (DSR)
EV_ERR = 0x0080  # Error in line status
EV_RING = 0x0100  # Change in Ring Indicator (RI)
EV_RLSD = 0x0020  # Change in Receive Line Signal Detect (RLSD)
EV_RXCHAR = 0x0001  # Character received
EV_RXFLAG = 0x0002  # Event character received
EV_TXEMPTY = 0x0004  # Transmitter empty
PURGE_TXABORT = 0x0001  # Terminate outstanding overlapped writes
PURGE_RXABORT = 0x0002  # Terminate outstanding overlapped reads
PURGE_TXCLEAR = 0x0004  # Clear the transmit buffer
PURGE_RXCLEAR = 0x0008  # Clear the receive buffer
